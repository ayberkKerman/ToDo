{"ast":null,"code":"/* jshint laxcomma: true */\nvar utils = require('./utils');\n\nexports.C14nCanonicalization = C14nCanonicalization;\nexports.C14nCanonicalizationWithComments = C14nCanonicalizationWithComments;\n\nfunction C14nCanonicalization() {\n  this.includeComments = false;\n}\n\n;\n\nC14nCanonicalization.prototype.attrCompare = function (a, b) {\n  if (!a.namespaceURI && b.namespaceURI) {\n    return -1;\n  }\n\n  if (!b.namespaceURI && a.namespaceURI) {\n    return 1;\n  }\n\n  var left = a.namespaceURI + a.localName;\n  var right = b.namespaceURI + b.localName;\n  if (left === right) return 0;else if (left < right) return -1;else return 1;\n};\n\nC14nCanonicalization.prototype.nsCompare = function (a, b) {\n  var attr1 = a.prefix;\n  var attr2 = b.prefix;\n\n  if (attr1 == attr2) {\n    return 0;\n  }\n\n  return attr1.localeCompare(attr2);\n};\n\nC14nCanonicalization.prototype.renderAttrs = function (node, defaultNS) {\n  var a,\n      i,\n      attr,\n      res = [],\n      attrListToRender = [];\n\n  if (node.nodeType === 8) {\n    return this.renderComment(node);\n  }\n\n  if (node.attributes) {\n    for (i = 0; i < node.attributes.length; ++i) {\n      attr = node.attributes[i]; //ignore namespace definition attributes\n\n      if (attr.name.indexOf(\"xmlns\") === 0) {\n        continue;\n      }\n\n      attrListToRender.push(attr);\n    }\n  }\n\n  attrListToRender.sort(this.attrCompare);\n\n  for (a in attrListToRender) {\n    if (!attrListToRender.hasOwnProperty(a)) {\n      continue;\n    }\n\n    attr = attrListToRender[a];\n    res.push(\" \", attr.name, '=\"', utils.encodeSpecialCharactersInAttribute(attr.value), '\"');\n  }\n\n  return res.join(\"\");\n};\n/**\n * Create the string of all namespace declarations that should appear on this element\n *\n * @param {Node} node. The node we now render\n * @param {Array} prefixesInScope. The prefixes defined on this node\n *                parents which are a part of the output set\n * @param {String} defaultNs. The current default namespace\n * @param {String} defaultNsForPrefix.\n * @param {String} ancestorNamespaces - Import ancestor namespaces if it is specified\n * @return {String}\n * @api private\n */\n\n\nC14nCanonicalization.prototype.renderNs = function (node, prefixesInScope, defaultNs, defaultNsForPrefix, ancestorNamespaces) {\n  var a,\n      i,\n      p,\n      attr,\n      res = [],\n      newDefaultNs = defaultNs,\n      nsListToRender = [],\n      currNs = node.namespaceURI || \"\"; //handle the namespaceof the node itself\n\n  if (node.prefix) {\n    if (prefixesInScope.indexOf(node.prefix) == -1) {\n      nsListToRender.push({\n        \"prefix\": node.prefix,\n        \"namespaceURI\": node.namespaceURI || defaultNsForPrefix[node.prefix]\n      });\n      prefixesInScope.push(node.prefix);\n    }\n  } else if (defaultNs != currNs) {\n    //new default ns\n    newDefaultNs = node.namespaceURI;\n    res.push(' xmlns=\"', newDefaultNs, '\"');\n  } //handle the attributes namespace\n\n\n  if (node.attributes) {\n    for (i = 0; i < node.attributes.length; ++i) {\n      attr = node.attributes[i]; //handle all prefixed attributes that are included in the prefix list and where\n      //the prefix is not defined already. New prefixes can only be defined by `xmlns:`.\n\n      if (attr.prefix === \"xmlns\" && prefixesInScope.indexOf(attr.localName) === -1) {\n        nsListToRender.push({\n          \"prefix\": attr.localName,\n          \"namespaceURI\": attr.value\n        });\n        prefixesInScope.push(attr.localName);\n      } //handle all prefixed attributes that are not xmlns definitions and where\n      //the prefix is not defined already\n\n\n      if (attr.prefix && prefixesInScope.indexOf(attr.prefix) == -1 && attr.prefix != \"xmlns\" && attr.prefix != \"xml\") {\n        nsListToRender.push({\n          \"prefix\": attr.prefix,\n          \"namespaceURI\": attr.namespaceURI\n        });\n        prefixesInScope.push(attr.prefix);\n      }\n    }\n  }\n\n  if (Array.isArray(ancestorNamespaces) && ancestorNamespaces.length > 0) {\n    // Remove namespaces which are already present in nsListToRender\n    for (var p1 in ancestorNamespaces) {\n      if (!ancestorNamespaces.hasOwnProperty(p1)) continue;\n      var alreadyListed = false;\n\n      for (var p2 in nsListToRender) {\n        if (nsListToRender[p2].prefix === ancestorNamespaces[p1].prefix && nsListToRender[p2].namespaceURI === ancestorNamespaces[p1].namespaceURI) {\n          alreadyListed = true;\n        }\n      }\n\n      if (!alreadyListed) {\n        nsListToRender.push(ancestorNamespaces[p1]);\n      }\n    }\n  }\n\n  nsListToRender.sort(this.nsCompare); //render namespaces\n\n  for (a in nsListToRender) {\n    if (!nsListToRender.hasOwnProperty(a)) {\n      continue;\n    }\n\n    p = nsListToRender[a];\n    res.push(\" xmlns:\", p.prefix, '=\"', p.namespaceURI, '\"');\n  }\n\n  return {\n    \"rendered\": res.join(\"\"),\n    \"newDefaultNs\": newDefaultNs\n  };\n};\n\nC14nCanonicalization.prototype.processInner = function (node, prefixesInScope, defaultNs, defaultNsForPrefix, ancestorNamespaces) {\n  if (node.nodeType === 8) {\n    return this.renderComment(node);\n  }\n\n  if (node.data) {\n    return utils.encodeSpecialCharactersInText(node.data);\n  }\n\n  var i,\n      pfxCopy,\n      ns = this.renderNs(node, prefixesInScope, defaultNs, defaultNsForPrefix, ancestorNamespaces),\n      res = [\"<\", node.tagName, ns.rendered, this.renderAttrs(node, ns.newDefaultNs), \">\"];\n\n  for (i = 0; i < node.childNodes.length; ++i) {\n    pfxCopy = prefixesInScope.slice(0);\n    res.push(this.processInner(node.childNodes[i], pfxCopy, ns.newDefaultNs, defaultNsForPrefix, []));\n  }\n\n  res.push(\"</\", node.tagName, \">\");\n  return res.join(\"\");\n}; // Thanks to deoxxa/xml-c14n for comment renderer\n\n\nC14nCanonicalization.prototype.renderComment = function (node) {\n  if (!this.includeComments) {\n    return \"\";\n  }\n\n  var isOutsideDocument = node.ownerDocument === node.parentNode,\n      isBeforeDocument = null,\n      isAfterDocument = null;\n\n  if (isOutsideDocument) {\n    var nextNode = node,\n        previousNode = node;\n\n    while (nextNode !== null) {\n      if (nextNode === node.ownerDocument.documentElement) {\n        isBeforeDocument = true;\n        break;\n      }\n\n      nextNode = nextNode.nextSibling;\n    }\n\n    while (previousNode !== null) {\n      if (previousNode === node.ownerDocument.documentElement) {\n        isAfterDocument = true;\n        break;\n      }\n\n      previousNode = previousNode.previousSibling;\n    }\n  }\n\n  return (isAfterDocument ? \"\\n\" : \"\") + \"<!--\" + utils.encodeSpecialCharactersInText(node.data) + \"-->\" + (isBeforeDocument ? \"\\n\" : \"\");\n};\n/**\n * Perform canonicalization of the given node\n *\n * @param {Node} node\n * @return {String}\n * @api public\n */\n\n\nC14nCanonicalization.prototype.process = function (node, options) {\n  options = options || {};\n  var defaultNs = options.defaultNs || \"\";\n  var defaultNsForPrefix = options.defaultNsForPrefix || {};\n  var ancestorNamespaces = options.ancestorNamespaces || [];\n  var res = this.processInner(node, [], defaultNs, defaultNsForPrefix, ancestorNamespaces);\n  return res;\n};\n\nC14nCanonicalization.prototype.getAlgorithmName = function () {\n  return \"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\";\n}; // Add c14n#WithComments here (very simple subclass)\n\n\nexports.C14nCanonicalizationWithComments = C14nCanonicalizationWithComments;\n\nfunction C14nCanonicalizationWithComments() {\n  C14nCanonicalization.call(this);\n  this.includeComments = true;\n}\n\n;\nC14nCanonicalizationWithComments.prototype = Object.create(C14nCanonicalization.prototype);\nC14nCanonicalizationWithComments.prototype.constructor = C14nCanonicalizationWithComments;\n\nC14nCanonicalizationWithComments.prototype.getAlgorithmName = function () {\n  return \"http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments\";\n};","map":{"version":3,"names":["utils","require","exports","C14nCanonicalization","C14nCanonicalizationWithComments","includeComments","prototype","attrCompare","a","b","namespaceURI","left","localName","right","nsCompare","attr1","prefix","attr2","localeCompare","renderAttrs","node","defaultNS","i","attr","res","attrListToRender","nodeType","renderComment","attributes","length","name","indexOf","push","sort","hasOwnProperty","encodeSpecialCharactersInAttribute","value","join","renderNs","prefixesInScope","defaultNs","defaultNsForPrefix","ancestorNamespaces","p","newDefaultNs","nsListToRender","currNs","Array","isArray","p1","alreadyListed","p2","processInner","data","encodeSpecialCharactersInText","pfxCopy","ns","tagName","rendered","childNodes","slice","isOutsideDocument","ownerDocument","parentNode","isBeforeDocument","isAfterDocument","nextNode","previousNode","documentElement","nextSibling","previousSibling","process","options","getAlgorithmName","call","Object","create","constructor"],"sources":["C:/Users/ayber/node_modules/xml-crypto/lib/c14n-canonicalization.js"],"sourcesContent":["/* jshint laxcomma: true */\nvar utils = require('./utils');\n\nexports.C14nCanonicalization = C14nCanonicalization;\nexports.C14nCanonicalizationWithComments = C14nCanonicalizationWithComments;\n\nfunction C14nCanonicalization() {\n\tthis.includeComments = false;\n};\n\nC14nCanonicalization.prototype.attrCompare = function(a,b) {\n  if (!a.namespaceURI && b.namespaceURI) { return -1; }\n  if (!b.namespaceURI && a.namespaceURI) { return 1; }\n\n  var left = a.namespaceURI + a.localName\n  var right = b.namespaceURI + b.localName\n\n  if (left===right) return 0\n  else if (left<right) return -1\n  else return 1\n\n};\n\nC14nCanonicalization.prototype.nsCompare = function(a,b) {\n  var attr1 = a.prefix;\n  var attr2 = b.prefix;\n  if (attr1 == attr2) { return 0; }\n  return attr1.localeCompare(attr2);\n};\n\nC14nCanonicalization.prototype.renderAttrs = function(node, defaultNS) {\n  var a, i, attr\n    , res = []\n    , attrListToRender = [];\n\n  if (node.nodeType===8) { return this.renderComment(node); }\n\n  if (node.attributes) {\n    for (i = 0; i < node.attributes.length; ++i) {\n      attr = node.attributes[i];\n      //ignore namespace definition attributes\n      if (attr.name.indexOf(\"xmlns\") === 0) { continue; }\n      attrListToRender.push(attr);\n    }\n  }\n\n  attrListToRender.sort(this.attrCompare);\n\n  for (a in attrListToRender) {\n    if (!attrListToRender.hasOwnProperty(a)) { continue; }\n\n    attr = attrListToRender[a];\n    res.push(\" \", attr.name, '=\"', utils.encodeSpecialCharactersInAttribute(attr.value), '\"');\n  }\n\n  return res.join(\"\");\n};\n\n\n/**\n * Create the string of all namespace declarations that should appear on this element\n *\n * @param {Node} node. The node we now render\n * @param {Array} prefixesInScope. The prefixes defined on this node\n *                parents which are a part of the output set\n * @param {String} defaultNs. The current default namespace\n * @param {String} defaultNsForPrefix.\n * @param {String} ancestorNamespaces - Import ancestor namespaces if it is specified\n * @return {String}\n * @api private\n */\nC14nCanonicalization.prototype.renderNs = function(node, prefixesInScope, defaultNs, defaultNsForPrefix, ancestorNamespaces) {\n  var a, i, p, attr\n    , res = []\n    , newDefaultNs = defaultNs\n    , nsListToRender = []\n    , currNs = node.namespaceURI || \"\";\n\n  //handle the namespaceof the node itself\n  if (node.prefix) {\n    if (prefixesInScope.indexOf(node.prefix)==-1) {\n      nsListToRender.push({\"prefix\": node.prefix, \"namespaceURI\": node.namespaceURI || defaultNsForPrefix[node.prefix]});\n      prefixesInScope.push(node.prefix);\n    }\n  }\n  else if (defaultNs!=currNs) {\n      //new default ns\n      newDefaultNs = node.namespaceURI;\n      res.push(' xmlns=\"', newDefaultNs, '\"');\n  }\n\n  //handle the attributes namespace\n  if (node.attributes) {\n    for (i = 0; i < node.attributes.length; ++i) {\n      attr = node.attributes[i];\n\n      //handle all prefixed attributes that are included in the prefix list and where\n      //the prefix is not defined already. New prefixes can only be defined by `xmlns:`.\n      if (attr.prefix === \"xmlns\" && prefixesInScope.indexOf(attr.localName) === -1) {\n        nsListToRender.push({\"prefix\": attr.localName, \"namespaceURI\": attr.value});\n        prefixesInScope.push(attr.localName);\n      }\n\n      //handle all prefixed attributes that are not xmlns definitions and where\n      //the prefix is not defined already\n      if (attr.prefix && prefixesInScope.indexOf(attr.prefix)==-1 && attr.prefix!=\"xmlns\" && attr.prefix!=\"xml\") {\n        nsListToRender.push({\"prefix\": attr.prefix, \"namespaceURI\": attr.namespaceURI});\n        prefixesInScope.push(attr.prefix);\n      }\n    }\n  }\n  \n  if(Array.isArray(ancestorNamespaces) && ancestorNamespaces.length > 0){\n    // Remove namespaces which are already present in nsListToRender\n    for(var p1 in ancestorNamespaces){\n      if(!ancestorNamespaces.hasOwnProperty(p1)) continue;\n      var alreadyListed = false;\n      for(var p2 in nsListToRender){\n        if(nsListToRender[p2].prefix === ancestorNamespaces[p1].prefix\n          && nsListToRender[p2].namespaceURI === ancestorNamespaces[p1].namespaceURI)\n        {\n          alreadyListed = true;\n        }\n      }\n      \n      if(!alreadyListed){\n        nsListToRender.push(ancestorNamespaces[p1]);\n      }\n    }\n  }\n\n  nsListToRender.sort(this.nsCompare);\n\n  //render namespaces\n  for (a in nsListToRender) {\n    if (!nsListToRender.hasOwnProperty(a)) { continue; }\n\n    p = nsListToRender[a];\n    res.push(\" xmlns:\", p.prefix, '=\"', p.namespaceURI, '\"');\n  }\n\n  return {\"rendered\": res.join(\"\"), \"newDefaultNs\": newDefaultNs};\n};\n\nC14nCanonicalization.prototype.processInner = function(node, prefixesInScope, defaultNs, defaultNsForPrefix, ancestorNamespaces) {\n\n  if (node.nodeType === 8) { return this.renderComment(node); }\n  if (node.data) { return utils.encodeSpecialCharactersInText(node.data); }\n\n  var i, pfxCopy\n    , ns = this.renderNs(node, prefixesInScope, defaultNs, defaultNsForPrefix, ancestorNamespaces)\n    , res = [\"<\", node.tagName, ns.rendered, this.renderAttrs(node, ns.newDefaultNs), \">\"];\n\n  for (i = 0; i < node.childNodes.length; ++i) {\n    pfxCopy = prefixesInScope.slice(0);\n    res.push(this.processInner(node.childNodes[i], pfxCopy, ns.newDefaultNs, defaultNsForPrefix, []));\n  }\n\n  res.push(\"</\", node.tagName, \">\");\n  return res.join(\"\");\n};\n\n// Thanks to deoxxa/xml-c14n for comment renderer\nC14nCanonicalization.prototype.renderComment = function (node) {\n\n  if (!this.includeComments) { return \"\"; }\n\n  var isOutsideDocument = (node.ownerDocument === node.parentNode),\n      isBeforeDocument = null,\n      isAfterDocument = null;\n\n  if (isOutsideDocument) {\n    var nextNode = node,\n        previousNode = node;\n\n    while (nextNode !== null) {\n      if (nextNode === node.ownerDocument.documentElement) {\n        isBeforeDocument = true;\n        break;\n      }\n\n      nextNode = nextNode.nextSibling;\n    }\n\n    while (previousNode !== null) {\n      if (previousNode === node.ownerDocument.documentElement) {\n        isAfterDocument = true;\n        break;\n      }\n\n      previousNode = previousNode.previousSibling;\n    }\n  }\n\n  return (isAfterDocument ? \"\\n\" : \"\") + \"<!--\" + utils.encodeSpecialCharactersInText(node.data) + \"-->\" + (isBeforeDocument ? \"\\n\" : \"\");\n};\n\n/**\n * Perform canonicalization of the given node\n *\n * @param {Node} node\n * @return {String}\n * @api public\n */\nC14nCanonicalization.prototype.process = function(node, options) {\n  options = options || {};\n  var defaultNs = options.defaultNs || \"\";\n  var defaultNsForPrefix = options.defaultNsForPrefix || {};\n  var ancestorNamespaces = options.ancestorNamespaces || [];\n\n  var res = this.processInner(node, [], defaultNs, defaultNsForPrefix, ancestorNamespaces);\n  return res;\n};\n\nC14nCanonicalization.prototype.getAlgorithmName = function() {\n  return \"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\";\n};\n\n// Add c14n#WithComments here (very simple subclass)\nexports.C14nCanonicalizationWithComments = C14nCanonicalizationWithComments;\n\nfunction C14nCanonicalizationWithComments() {\n\tC14nCanonicalization.call(this);\n\tthis.includeComments = true;\n};\n\nC14nCanonicalizationWithComments.prototype = Object.create(C14nCanonicalization.prototype);\n\nC14nCanonicalizationWithComments.prototype.constructor = C14nCanonicalizationWithComments;\n\nC14nCanonicalizationWithComments.prototype.getAlgorithmName = function() {\n  return \"http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments\";\n};\n"],"mappings":"AAAA;AACA,IAAIA,KAAK,GAAGC,OAAO,CAAC,SAAD,CAAnB;;AAEAC,OAAO,CAACC,oBAAR,GAA+BA,oBAA/B;AACAD,OAAO,CAACE,gCAAR,GAA2CA,gCAA3C;;AAEA,SAASD,oBAAT,GAAgC;EAC/B,KAAKE,eAAL,GAAuB,KAAvB;AACA;;AAAA;;AAEDF,oBAAoB,CAACG,SAArB,CAA+BC,WAA/B,GAA6C,UAASC,CAAT,EAAWC,CAAX,EAAc;EACzD,IAAI,CAACD,CAAC,CAACE,YAAH,IAAmBD,CAAC,CAACC,YAAzB,EAAuC;IAAE,OAAO,CAAC,CAAR;EAAY;;EACrD,IAAI,CAACD,CAAC,CAACC,YAAH,IAAmBF,CAAC,CAACE,YAAzB,EAAuC;IAAE,OAAO,CAAP;EAAW;;EAEpD,IAAIC,IAAI,GAAGH,CAAC,CAACE,YAAF,GAAiBF,CAAC,CAACI,SAA9B;EACA,IAAIC,KAAK,GAAGJ,CAAC,CAACC,YAAF,GAAiBD,CAAC,CAACG,SAA/B;EAEA,IAAID,IAAI,KAAGE,KAAX,EAAkB,OAAO,CAAP,CAAlB,KACK,IAAIF,IAAI,GAACE,KAAT,EAAgB,OAAO,CAAC,CAAR,CAAhB,KACA,OAAO,CAAP;AAEN,CAXD;;AAaAV,oBAAoB,CAACG,SAArB,CAA+BQ,SAA/B,GAA2C,UAASN,CAAT,EAAWC,CAAX,EAAc;EACvD,IAAIM,KAAK,GAAGP,CAAC,CAACQ,MAAd;EACA,IAAIC,KAAK,GAAGR,CAAC,CAACO,MAAd;;EACA,IAAID,KAAK,IAAIE,KAAb,EAAoB;IAAE,OAAO,CAAP;EAAW;;EACjC,OAAOF,KAAK,CAACG,aAAN,CAAoBD,KAApB,CAAP;AACD,CALD;;AAOAd,oBAAoB,CAACG,SAArB,CAA+Ba,WAA/B,GAA6C,UAASC,IAAT,EAAeC,SAAf,EAA0B;EACrE,IAAIb,CAAJ;EAAA,IAAOc,CAAP;EAAA,IAAUC,IAAV;EAAA,IACIC,GAAG,GAAG,EADV;EAAA,IAEIC,gBAAgB,GAAG,EAFvB;;EAIA,IAAIL,IAAI,CAACM,QAAL,KAAgB,CAApB,EAAuB;IAAE,OAAO,KAAKC,aAAL,CAAmBP,IAAnB,CAAP;EAAkC;;EAE3D,IAAIA,IAAI,CAACQ,UAAT,EAAqB;IACnB,KAAKN,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGF,IAAI,CAACQ,UAAL,CAAgBC,MAAhC,EAAwC,EAAEP,CAA1C,EAA6C;MAC3CC,IAAI,GAAGH,IAAI,CAACQ,UAAL,CAAgBN,CAAhB,CAAP,CAD2C,CAE3C;;MACA,IAAIC,IAAI,CAACO,IAAL,CAAUC,OAAV,CAAkB,OAAlB,MAA+B,CAAnC,EAAsC;QAAE;MAAW;;MACnDN,gBAAgB,CAACO,IAAjB,CAAsBT,IAAtB;IACD;EACF;;EAEDE,gBAAgB,CAACQ,IAAjB,CAAsB,KAAK1B,WAA3B;;EAEA,KAAKC,CAAL,IAAUiB,gBAAV,EAA4B;IAC1B,IAAI,CAACA,gBAAgB,CAACS,cAAjB,CAAgC1B,CAAhC,CAAL,EAAyC;MAAE;IAAW;;IAEtDe,IAAI,GAAGE,gBAAgB,CAACjB,CAAD,CAAvB;IACAgB,GAAG,CAACQ,IAAJ,CAAS,GAAT,EAAcT,IAAI,CAACO,IAAnB,EAAyB,IAAzB,EAA+B9B,KAAK,CAACmC,kCAAN,CAAyCZ,IAAI,CAACa,KAA9C,CAA/B,EAAqF,GAArF;EACD;;EAED,OAAOZ,GAAG,CAACa,IAAJ,CAAS,EAAT,CAAP;AACD,CA1BD;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAlC,oBAAoB,CAACG,SAArB,CAA+BgC,QAA/B,GAA0C,UAASlB,IAAT,EAAemB,eAAf,EAAgCC,SAAhC,EAA2CC,kBAA3C,EAA+DC,kBAA/D,EAAmF;EAC3H,IAAIlC,CAAJ;EAAA,IAAOc,CAAP;EAAA,IAAUqB,CAAV;EAAA,IAAapB,IAAb;EAAA,IACIC,GAAG,GAAG,EADV;EAAA,IAEIoB,YAAY,GAAGJ,SAFnB;EAAA,IAGIK,cAAc,GAAG,EAHrB;EAAA,IAIIC,MAAM,GAAG1B,IAAI,CAACV,YAAL,IAAqB,EAJlC,CAD2H,CAO3H;;EACA,IAAIU,IAAI,CAACJ,MAAT,EAAiB;IACf,IAAIuB,eAAe,CAACR,OAAhB,CAAwBX,IAAI,CAACJ,MAA7B,KAAsC,CAAC,CAA3C,EAA8C;MAC5C6B,cAAc,CAACb,IAAf,CAAoB;QAAC,UAAUZ,IAAI,CAACJ,MAAhB;QAAwB,gBAAgBI,IAAI,CAACV,YAAL,IAAqB+B,kBAAkB,CAACrB,IAAI,CAACJ,MAAN;MAA/E,CAApB;MACAuB,eAAe,CAACP,IAAhB,CAAqBZ,IAAI,CAACJ,MAA1B;IACD;EACF,CALD,MAMK,IAAIwB,SAAS,IAAEM,MAAf,EAAuB;IACxB;IACAF,YAAY,GAAGxB,IAAI,CAACV,YAApB;IACAc,GAAG,CAACQ,IAAJ,CAAS,UAAT,EAAqBY,YAArB,EAAmC,GAAnC;EACH,CAlB0H,CAoB3H;;;EACA,IAAIxB,IAAI,CAACQ,UAAT,EAAqB;IACnB,KAAKN,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGF,IAAI,CAACQ,UAAL,CAAgBC,MAAhC,EAAwC,EAAEP,CAA1C,EAA6C;MAC3CC,IAAI,GAAGH,IAAI,CAACQ,UAAL,CAAgBN,CAAhB,CAAP,CAD2C,CAG3C;MACA;;MACA,IAAIC,IAAI,CAACP,MAAL,KAAgB,OAAhB,IAA2BuB,eAAe,CAACR,OAAhB,CAAwBR,IAAI,CAACX,SAA7B,MAA4C,CAAC,CAA5E,EAA+E;QAC7EiC,cAAc,CAACb,IAAf,CAAoB;UAAC,UAAUT,IAAI,CAACX,SAAhB;UAA2B,gBAAgBW,IAAI,CAACa;QAAhD,CAApB;QACAG,eAAe,CAACP,IAAhB,CAAqBT,IAAI,CAACX,SAA1B;MACD,CAR0C,CAU3C;MACA;;;MACA,IAAIW,IAAI,CAACP,MAAL,IAAeuB,eAAe,CAACR,OAAhB,CAAwBR,IAAI,CAACP,MAA7B,KAAsC,CAAC,CAAtD,IAA2DO,IAAI,CAACP,MAAL,IAAa,OAAxE,IAAmFO,IAAI,CAACP,MAAL,IAAa,KAApG,EAA2G;QACzG6B,cAAc,CAACb,IAAf,CAAoB;UAAC,UAAUT,IAAI,CAACP,MAAhB;UAAwB,gBAAgBO,IAAI,CAACb;QAA7C,CAApB;QACA6B,eAAe,CAACP,IAAhB,CAAqBT,IAAI,CAACP,MAA1B;MACD;IACF;EACF;;EAED,IAAG+B,KAAK,CAACC,OAAN,CAAcN,kBAAd,KAAqCA,kBAAkB,CAACb,MAAnB,GAA4B,CAApE,EAAsE;IACpE;IACA,KAAI,IAAIoB,EAAR,IAAcP,kBAAd,EAAiC;MAC/B,IAAG,CAACA,kBAAkB,CAACR,cAAnB,CAAkCe,EAAlC,CAAJ,EAA2C;MAC3C,IAAIC,aAAa,GAAG,KAApB;;MACA,KAAI,IAAIC,EAAR,IAAcN,cAAd,EAA6B;QAC3B,IAAGA,cAAc,CAACM,EAAD,CAAd,CAAmBnC,MAAnB,KAA8B0B,kBAAkB,CAACO,EAAD,CAAlB,CAAuBjC,MAArD,IACE6B,cAAc,CAACM,EAAD,CAAd,CAAmBzC,YAAnB,KAAoCgC,kBAAkB,CAACO,EAAD,CAAlB,CAAuBvC,YADhE,EAEA;UACEwC,aAAa,GAAG,IAAhB;QACD;MACF;;MAED,IAAG,CAACA,aAAJ,EAAkB;QAChBL,cAAc,CAACb,IAAf,CAAoBU,kBAAkB,CAACO,EAAD,CAAtC;MACD;IACF;EACF;;EAEDJ,cAAc,CAACZ,IAAf,CAAoB,KAAKnB,SAAzB,EA5D2H,CA8D3H;;EACA,KAAKN,CAAL,IAAUqC,cAAV,EAA0B;IACxB,IAAI,CAACA,cAAc,CAACX,cAAf,CAA8B1B,CAA9B,CAAL,EAAuC;MAAE;IAAW;;IAEpDmC,CAAC,GAAGE,cAAc,CAACrC,CAAD,CAAlB;IACAgB,GAAG,CAACQ,IAAJ,CAAS,SAAT,EAAoBW,CAAC,CAAC3B,MAAtB,EAA8B,IAA9B,EAAoC2B,CAAC,CAACjC,YAAtC,EAAoD,GAApD;EACD;;EAED,OAAO;IAAC,YAAYc,GAAG,CAACa,IAAJ,CAAS,EAAT,CAAb;IAA2B,gBAAgBO;EAA3C,CAAP;AACD,CAvED;;AAyEAzC,oBAAoB,CAACG,SAArB,CAA+B8C,YAA/B,GAA8C,UAAShC,IAAT,EAAemB,eAAf,EAAgCC,SAAhC,EAA2CC,kBAA3C,EAA+DC,kBAA/D,EAAmF;EAE/H,IAAItB,IAAI,CAACM,QAAL,KAAkB,CAAtB,EAAyB;IAAE,OAAO,KAAKC,aAAL,CAAmBP,IAAnB,CAAP;EAAkC;;EAC7D,IAAIA,IAAI,CAACiC,IAAT,EAAe;IAAE,OAAOrD,KAAK,CAACsD,6BAAN,CAAoClC,IAAI,CAACiC,IAAzC,CAAP;EAAwD;;EAEzE,IAAI/B,CAAJ;EAAA,IAAOiC,OAAP;EAAA,IACIC,EAAE,GAAG,KAAKlB,QAAL,CAAclB,IAAd,EAAoBmB,eAApB,EAAqCC,SAArC,EAAgDC,kBAAhD,EAAoEC,kBAApE,CADT;EAAA,IAEIlB,GAAG,GAAG,CAAC,GAAD,EAAMJ,IAAI,CAACqC,OAAX,EAAoBD,EAAE,CAACE,QAAvB,EAAiC,KAAKvC,WAAL,CAAiBC,IAAjB,EAAuBoC,EAAE,CAACZ,YAA1B,CAAjC,EAA0E,GAA1E,CAFV;;EAIA,KAAKtB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGF,IAAI,CAACuC,UAAL,CAAgB9B,MAAhC,EAAwC,EAAEP,CAA1C,EAA6C;IAC3CiC,OAAO,GAAGhB,eAAe,CAACqB,KAAhB,CAAsB,CAAtB,CAAV;IACApC,GAAG,CAACQ,IAAJ,CAAS,KAAKoB,YAAL,CAAkBhC,IAAI,CAACuC,UAAL,CAAgBrC,CAAhB,CAAlB,EAAsCiC,OAAtC,EAA+CC,EAAE,CAACZ,YAAlD,EAAgEH,kBAAhE,EAAoF,EAApF,CAAT;EACD;;EAEDjB,GAAG,CAACQ,IAAJ,CAAS,IAAT,EAAeZ,IAAI,CAACqC,OAApB,EAA6B,GAA7B;EACA,OAAOjC,GAAG,CAACa,IAAJ,CAAS,EAAT,CAAP;AACD,CAhBD,C,CAkBA;;;AACAlC,oBAAoB,CAACG,SAArB,CAA+BqB,aAA/B,GAA+C,UAAUP,IAAV,EAAgB;EAE7D,IAAI,CAAC,KAAKf,eAAV,EAA2B;IAAE,OAAO,EAAP;EAAY;;EAEzC,IAAIwD,iBAAiB,GAAIzC,IAAI,CAAC0C,aAAL,KAAuB1C,IAAI,CAAC2C,UAArD;EAAA,IACIC,gBAAgB,GAAG,IADvB;EAAA,IAEIC,eAAe,GAAG,IAFtB;;EAIA,IAAIJ,iBAAJ,EAAuB;IACrB,IAAIK,QAAQ,GAAG9C,IAAf;IAAA,IACI+C,YAAY,GAAG/C,IADnB;;IAGA,OAAO8C,QAAQ,KAAK,IAApB,EAA0B;MACxB,IAAIA,QAAQ,KAAK9C,IAAI,CAAC0C,aAAL,CAAmBM,eAApC,EAAqD;QACnDJ,gBAAgB,GAAG,IAAnB;QACA;MACD;;MAEDE,QAAQ,GAAGA,QAAQ,CAACG,WAApB;IACD;;IAED,OAAOF,YAAY,KAAK,IAAxB,EAA8B;MAC5B,IAAIA,YAAY,KAAK/C,IAAI,CAAC0C,aAAL,CAAmBM,eAAxC,EAAyD;QACvDH,eAAe,GAAG,IAAlB;QACA;MACD;;MAEDE,YAAY,GAAGA,YAAY,CAACG,eAA5B;IACD;EACF;;EAED,OAAO,CAACL,eAAe,GAAG,IAAH,GAAU,EAA1B,IAAgC,MAAhC,GAAyCjE,KAAK,CAACsD,6BAAN,CAAoClC,IAAI,CAACiC,IAAzC,CAAzC,GAA0F,KAA1F,IAAmGW,gBAAgB,GAAG,IAAH,GAAU,EAA7H,CAAP;AACD,CAhCD;AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA7D,oBAAoB,CAACG,SAArB,CAA+BiE,OAA/B,GAAyC,UAASnD,IAAT,EAAeoD,OAAf,EAAwB;EAC/DA,OAAO,GAAGA,OAAO,IAAI,EAArB;EACA,IAAIhC,SAAS,GAAGgC,OAAO,CAAChC,SAAR,IAAqB,EAArC;EACA,IAAIC,kBAAkB,GAAG+B,OAAO,CAAC/B,kBAAR,IAA8B,EAAvD;EACA,IAAIC,kBAAkB,GAAG8B,OAAO,CAAC9B,kBAAR,IAA8B,EAAvD;EAEA,IAAIlB,GAAG,GAAG,KAAK4B,YAAL,CAAkBhC,IAAlB,EAAwB,EAAxB,EAA4BoB,SAA5B,EAAuCC,kBAAvC,EAA2DC,kBAA3D,CAAV;EACA,OAAOlB,GAAP;AACD,CARD;;AAUArB,oBAAoB,CAACG,SAArB,CAA+BmE,gBAA/B,GAAkD,YAAW;EAC3D,OAAO,iDAAP;AACD,CAFD,C,CAIA;;;AACAvE,OAAO,CAACE,gCAAR,GAA2CA,gCAA3C;;AAEA,SAASA,gCAAT,GAA4C;EAC3CD,oBAAoB,CAACuE,IAArB,CAA0B,IAA1B;EACA,KAAKrE,eAAL,GAAuB,IAAvB;AACA;;AAAA;AAEDD,gCAAgC,CAACE,SAAjC,GAA6CqE,MAAM,CAACC,MAAP,CAAczE,oBAAoB,CAACG,SAAnC,CAA7C;AAEAF,gCAAgC,CAACE,SAAjC,CAA2CuE,WAA3C,GAAyDzE,gCAAzD;;AAEAA,gCAAgC,CAACE,SAAjC,CAA2CmE,gBAA3C,GAA8D,YAAW;EACvE,OAAO,8DAAP;AACD,CAFD"},"metadata":{},"sourceType":"script"}