{"ast":null,"code":"var select = require('xpath').select;\n\nfunction findAttr(node, localName, namespace) {\n  for (var i = 0; i < node.attributes.length; i++) {\n    var attr = node.attributes[i];\n\n    if (attrEqualsExplicitly(attr, localName, namespace) || attrEqualsImplicitly(attr, localName, namespace, node)) {\n      return attr;\n    }\n  }\n\n  return null;\n}\n\nfunction findFirst(doc, xpath) {\n  var nodes = select(xpath, doc);\n  if (nodes.length == 0) throw \"could not find xpath \" + xpath;\n  return nodes[0];\n}\n\nfunction findChilds(node, localName, namespace) {\n  node = node.documentElement || node;\n  var res = [];\n\n  for (var i = 0; i < node.childNodes.length; i++) {\n    var child = node.childNodes[i];\n\n    if (child.localName == localName && (child.namespaceURI == namespace || !namespace)) {\n      res.push(child);\n    }\n  }\n\n  return res;\n}\n\nfunction attrEqualsExplicitly(attr, localName, namespace) {\n  return attr.localName == localName && (attr.namespaceURI == namespace || !namespace);\n}\n\nfunction attrEqualsImplicitly(attr, localName, namespace, node) {\n  return attr.localName == localName && (!attr.namespaceURI && node.namespaceURI == namespace || !namespace);\n}\n\nvar xml_special_to_encoded_attribute = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '\"': '&quot;',\n  '\\r': '&#xD;',\n  '\\n': '&#xA;',\n  '\\t': '&#x9;'\n};\nvar xml_special_to_encoded_text = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\\r': '&#xD;'\n};\n\nfunction encodeSpecialCharactersInAttribute(attributeValue) {\n  return attributeValue.replace(/([&<\"\\r\\n\\t])/g, function (str, item) {\n    // Special character normalization. See:\n    // - https://www.w3.org/TR/xml-c14n#ProcessingModel (Attribute Nodes)\n    // - https://www.w3.org/TR/xml-c14n#Example-Chars\n    return xml_special_to_encoded_attribute[item];\n  });\n}\n\nfunction encodeSpecialCharactersInText(text) {\n  return text.replace(/([&<>\\r])/g, function (str, item) {\n    // Special character normalization. See:\n    // - https://www.w3.org/TR/xml-c14n#ProcessingModel (Text Nodes)\n    // - https://www.w3.org/TR/xml-c14n#Example-Chars\n    return xml_special_to_encoded_text[item];\n  });\n}\n\nexports.findAttr = findAttr;\nexports.findChilds = findChilds;\nexports.encodeSpecialCharactersInAttribute = encodeSpecialCharactersInAttribute;\nexports.encodeSpecialCharactersInText = encodeSpecialCharactersInText;\nexports.findFirst = findFirst;","map":{"version":3,"names":["select","require","findAttr","node","localName","namespace","i","attributes","length","attr","attrEqualsExplicitly","attrEqualsImplicitly","findFirst","doc","xpath","nodes","findChilds","documentElement","res","childNodes","child","namespaceURI","push","xml_special_to_encoded_attribute","xml_special_to_encoded_text","encodeSpecialCharactersInAttribute","attributeValue","replace","str","item","encodeSpecialCharactersInText","text","exports"],"sources":["C:/Users/ayber/node_modules/xml-crypto/lib/utils.js"],"sourcesContent":["var select = require('xpath').select\n\nfunction findAttr(node, localName, namespace) {\n  for (var i = 0; i<node.attributes.length; i++) {\n  \tvar attr = node.attributes[i]  \t\n\n  \tif (attrEqualsExplicitly(attr, localName, namespace) || attrEqualsImplicitly(attr, localName, namespace, node)) {  \t\t  \t\n  \t\treturn attr\n  \t}\n  }\n  return null\n}\n\nfunction findFirst(doc, xpath) {  \n  var nodes = select(xpath, doc)    \n  if (nodes.length==0) throw \"could not find xpath \" + xpath\n  return nodes[0]\n}\n\nfunction findChilds(node, localName, namespace) {\n  node = node.documentElement || node;\n  var res = []\n  for (var i = 0; i<node.childNodes.length; i++) {\n    var child = node.childNodes[i]       \n    if (child.localName==localName && (child.namespaceURI==namespace || !namespace)) {\n      res.push(child)\n    }\n  }\n  return res\n}\n\nfunction attrEqualsExplicitly(attr, localName, namespace) {\n\treturn attr.localName==localName && (attr.namespaceURI==namespace || !namespace)\n}\n\nfunction attrEqualsImplicitly(attr, localName, namespace, node) {\n\treturn attr.localName==localName && ((!attr.namespaceURI && node.namespaceURI==namespace) || !namespace)\n}\n\nvar xml_special_to_encoded_attribute = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '\"': '&quot;',\n    '\\r': '&#xD;',\n    '\\n': '&#xA;',\n    '\\t': '&#x9;'\n}\n\nvar xml_special_to_encoded_text = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\\r': '&#xD;'\n}\n\nfunction encodeSpecialCharactersInAttribute(attributeValue){\n    return attributeValue\n        .replace(/([&<\"\\r\\n\\t])/g, function(str, item){\n            // Special character normalization. See:\n            // - https://www.w3.org/TR/xml-c14n#ProcessingModel (Attribute Nodes)\n            // - https://www.w3.org/TR/xml-c14n#Example-Chars\n            return xml_special_to_encoded_attribute[item]\n        })\n}\n\nfunction encodeSpecialCharactersInText(text){\n    return text\n        .replace(/([&<>\\r])/g, function(str, item){\n            // Special character normalization. See:\n            // - https://www.w3.org/TR/xml-c14n#ProcessingModel (Text Nodes)\n            // - https://www.w3.org/TR/xml-c14n#Example-Chars\n            return xml_special_to_encoded_text[item]\n        })\n}\n\n\nexports.findAttr = findAttr\nexports.findChilds = findChilds\nexports.encodeSpecialCharactersInAttribute = encodeSpecialCharactersInAttribute\nexports.encodeSpecialCharactersInText = encodeSpecialCharactersInText\nexports.findFirst = findFirst\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}