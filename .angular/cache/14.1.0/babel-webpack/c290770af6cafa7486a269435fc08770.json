{"ast":null,"code":"var xpath = require('xpath');\n\nvar utils = require('./utils');\n\nexports.EnvelopedSignature = EnvelopedSignature;\n\nfunction EnvelopedSignature() {}\n\nEnvelopedSignature.prototype.process = function (node, options) {\n  if (null == options.signatureNode) {\n    // leave this for the moment...\n    var signature = xpath.select(\"./*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']\", node)[0];\n    if (signature) signature.parentNode.removeChild(signature);\n    return node;\n  }\n\n  var signatureNode = options.signatureNode;\n  var expectedSignatureValue = utils.findFirst(signatureNode, \".//*[local-name(.)='SignatureValue']/text()\").data;\n  var signatures = xpath.select(\".//*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']\", node);\n\n  for (var h in signatures) {\n    if (!signatures.hasOwnProperty(h)) continue;\n    var signature = signatures[h];\n    var signatureValue = utils.findFirst(signature, \".//*[local-name(.)='SignatureValue']/text()\").data;\n\n    if (expectedSignatureValue === signatureValue) {\n      signature.parentNode.removeChild(signature);\n    }\n  }\n\n  return node;\n};\n\nEnvelopedSignature.prototype.getAlgorithmName = function () {\n  return \"http://www.w3.org/2000/09/xmldsig#enveloped-signature\";\n};","map":{"version":3,"names":["xpath","require","utils","exports","EnvelopedSignature","prototype","process","node","options","signatureNode","signature","select","parentNode","removeChild","expectedSignatureValue","findFirst","data","signatures","h","hasOwnProperty","signatureValue","getAlgorithmName"],"sources":["C:/Users/ayber/node_modules/xml-crypto/lib/enveloped-signature.js"],"sourcesContent":["var xpath = require('xpath');\nvar utils = require('./utils');\n\nexports.EnvelopedSignature = EnvelopedSignature;\n\nfunction EnvelopedSignature() {\n}\n\nEnvelopedSignature.prototype.process = function (node, options) {\n  if (null == options.signatureNode) {\n    // leave this for the moment...\n    var signature = xpath.select(\"./*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']\", node)[0];\n    if (signature) signature.parentNode.removeChild(signature);\n    return node;\n  }\n  var signatureNode = options.signatureNode;\n  var expectedSignatureValue = utils.findFirst(signatureNode, \".//*[local-name(.)='SignatureValue']/text()\").data;\n  var signatures = xpath.select(\".//*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']\", node);\n  for (var h in signatures) {\n    if (!signatures.hasOwnProperty(h)) continue;\n    var signature = signatures[h];\n    var signatureValue = utils.findFirst(signature, \".//*[local-name(.)='SignatureValue']/text()\").data;\n    if (expectedSignatureValue === signatureValue) {\n      signature.parentNode.removeChild(signature);\n    }\n  }\n  return node;\n};\n\nEnvelopedSignature.prototype.getAlgorithmName = function () {\n  return \"http://www.w3.org/2000/09/xmldsig#enveloped-signature\";\n};\n"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAAnB;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,SAAD,CAAnB;;AAEAE,OAAO,CAACC,kBAAR,GAA6BA,kBAA7B;;AAEA,SAASA,kBAAT,GAA8B,CAC7B;;AAEDA,kBAAkB,CAACC,SAAnB,CAA6BC,OAA7B,GAAuC,UAAUC,IAAV,EAAgBC,OAAhB,EAAyB;EAC9D,IAAI,QAAQA,OAAO,CAACC,aAApB,EAAmC;IACjC;IACA,IAAIC,SAAS,GAAGV,KAAK,CAACW,MAAN,CAAa,0FAAb,EAAyGJ,IAAzG,EAA+G,CAA/G,CAAhB;IACA,IAAIG,SAAJ,EAAeA,SAAS,CAACE,UAAV,CAAqBC,WAArB,CAAiCH,SAAjC;IACf,OAAOH,IAAP;EACD;;EACD,IAAIE,aAAa,GAAGD,OAAO,CAACC,aAA5B;EACA,IAAIK,sBAAsB,GAAGZ,KAAK,CAACa,SAAN,CAAgBN,aAAhB,EAA+B,6CAA/B,EAA8EO,IAA3G;EACA,IAAIC,UAAU,GAAGjB,KAAK,CAACW,MAAN,CAAa,2FAAb,EAA0GJ,IAA1G,CAAjB;;EACA,KAAK,IAAIW,CAAT,IAAcD,UAAd,EAA0B;IACxB,IAAI,CAACA,UAAU,CAACE,cAAX,CAA0BD,CAA1B,CAAL,EAAmC;IACnC,IAAIR,SAAS,GAAGO,UAAU,CAACC,CAAD,CAA1B;IACA,IAAIE,cAAc,GAAGlB,KAAK,CAACa,SAAN,CAAgBL,SAAhB,EAA2B,6CAA3B,EAA0EM,IAA/F;;IACA,IAAIF,sBAAsB,KAAKM,cAA/B,EAA+C;MAC7CV,SAAS,CAACE,UAAV,CAAqBC,WAArB,CAAiCH,SAAjC;IACD;EACF;;EACD,OAAOH,IAAP;AACD,CAnBD;;AAqBAH,kBAAkB,CAACC,SAAnB,CAA6BgB,gBAA7B,GAAgD,YAAY;EAC1D,OAAO,uDAAP;AACD,CAFD"},"metadata":{},"sourceType":"script"}